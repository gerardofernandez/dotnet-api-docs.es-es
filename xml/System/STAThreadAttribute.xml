<Type Name="STAThreadAttribute" FullName="System.STAThreadAttribute">
  <Metadata><Meta Name="ms.openlocfilehash" Value="cb55e251d450d8ba891c71064ed122c6af01e468" /><Meta Name="ms.sourcegitcommit" Value="0e1f030650a307c745ee84ed547ef858acaea587" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="es-ES" /><Meta Name="ms.lasthandoff" Value="11/29/2018" /><Meta Name="ms.locfileid" Value="52615443" /></Metadata><TypeSignature Language="C#" Value="public sealed class STAThreadAttribute : Attribute" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit STAThreadAttribute extends System.Attribute" />
  <TypeSignature Language="DocId" Value="T:System.STAThreadAttribute" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class STAThreadAttribute&#xA;Inherits Attribute" />
  <TypeSignature Language="C++ CLI" Value="public ref class STAThreadAttribute sealed : Attribute" />
  <TypeSignature Language="F#" Value="type STAThreadAttribute = class&#xA;    inherit Attribute" />
  <AssemblyInfo>
    <AssemblyName>System.Runtime</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.10.0</AssemblyVersion>
    <AssemblyVersion>4.0.20.0</AssemblyVersion>
    <AssemblyVersion>4.1.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.1.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>mscorlib</AssemblyName>
    <AssemblyVersion>1.0.5000.0</AssemblyVersion>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>netstandard</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Attribute</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute FrameworkAlternate="netcore-1.0;netcore-1.1;netcore-2.0;netcore-2.1;netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netstandard-1.0;netstandard-1.1;netstandard-1.2;netstandard-1.3;netstandard-1.4;netstandard-1.5;netstandard-1.6;netstandard-2.0;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0;netframework-4.8;netcore-2.2">
      <AttributeName>System.AttributeUsage(System.AttributeTargets.Method)</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinandroid-7.1;xamarinios-10.8;xamarinmac-3.0;netframework-4.8">
      <AttributeName>System.Runtime.InteropServices.ComVisible(true)</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="81aa6-101">Indica que el modelo de subprocesos COM de una aplicación es contenedor uniproceso (STA).</span><span class="sxs-lookup"><span data-stu-id="81aa6-101">Indicates that the COM threading model for an application is single-threaded apartment (STA).</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="81aa6-102">Aplique este atributo al método de punto de entrada (el `Main()` método en C# y Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="81aa6-102">Apply this attribute to the entry point method (the `Main()` method in C# and Visual Basic).</span></span> <span data-ttu-id="81aa6-103">No tiene ningún efecto en otros métodos.</span><span class="sxs-lookup"><span data-stu-id="81aa6-103">It has no effect on other methods.</span></span> <span data-ttu-id="81aa6-104">Para establecer el estado de apartamento de subprocesos que se inician en el código, utilice el <xref:System.Threading.Thread.SetApartmentState%2A?displayProperty=nameWithType> o <xref:System.Threading.Thread.TrySetApartmentState%2A?displayProperty=nameWithType> método antes de iniciar el subproceso.</span><span class="sxs-lookup"><span data-stu-id="81aa6-104">To set the apartment state of threads you start in your code, use the <xref:System.Threading.Thread.SetApartmentState%2A?displayProperty=nameWithType> or <xref:System.Threading.Thread.TrySetApartmentState%2A?displayProperty=nameWithType> method before starting the thread.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="81aa6-105">Para obtener información general de los modelos de subprocesos COM, vea [comprensión y Using COM Threading Models](https://msdn.microsoft.com/library/ms809971.aspx).</span><span class="sxs-lookup"><span data-stu-id="81aa6-105">For an overview of COM threading models, see [Understanding and Using COM Threading Models](https://msdn.microsoft.com/library/ms809971.aspx).</span></span>  
  
 <span data-ttu-id="81aa6-106">Los modelos de subprocesos COM solo se aplican a las aplicaciones que usan la interoperabilidad COM.</span><span class="sxs-lookup"><span data-stu-id="81aa6-106">COM threading models only apply to applications that use COM interop.</span></span> <span data-ttu-id="81aa6-107">El modelo de subprocesos de COM puede establecerse en el contenedor uniproceso o apartamento multiproceso.</span><span class="sxs-lookup"><span data-stu-id="81aa6-107">The COM threading model can be set to single-threaded apartment or multithreaded apartment.</span></span> <span data-ttu-id="81aa6-108">El subproceso de la aplicación sólo se inicializa para interoperabilidad COM si el subproceso realiza realmente una llamada a un componente COM.</span><span class="sxs-lookup"><span data-stu-id="81aa6-108">The application thread is only initialized for COM interop if the thread actually makes a call to a COM component.</span></span> <span data-ttu-id="81aa6-109">Si no se utiliza la interoperabilidad COM, entonces no se ha inicializado el subproceso y el <xref:System.STAThreadAttribute> atributo, si está presente, no tiene ningún efecto.</span><span class="sxs-lookup"><span data-stu-id="81aa6-109">If COM interop is not used, then the thread is not initialized, and the <xref:System.STAThreadAttribute> attribute, if it is present, has no effect.</span></span>  
  
 <span data-ttu-id="81aa6-110">A partir de la versión 2.0 de .NET Framework, el valor predeterminado el modelo para la interoperabilidad COM de subprocesos depende del idioma en el que está desarrollando la aplicación, como se muestra en la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="81aa6-110">Starting with the .NET Framework version 2.0, the default threading model for COM interop depends on the language in which you are developing your application, as the following table shows.</span></span>  
  
|<span data-ttu-id="81aa6-111">Lenguaje</span><span class="sxs-lookup"><span data-stu-id="81aa6-111">Language</span></span>|<span data-ttu-id="81aa6-112">Modelo de apartamento COM</span><span class="sxs-lookup"><span data-stu-id="81aa6-112">COM apartment model</span></span>|  
|--------------|-------------------------|  
|<span data-ttu-id="81aa6-113">C#</span><span class="sxs-lookup"><span data-stu-id="81aa6-113">C#</span></span>|<span data-ttu-id="81aa6-114">Apartamento multiproceso</span><span class="sxs-lookup"><span data-stu-id="81aa6-114">Multithreaded apartment</span></span>|  
|<span data-ttu-id="81aa6-115">C++</span><span class="sxs-lookup"><span data-stu-id="81aa6-115">C++</span></span>|<span data-ttu-id="81aa6-116">Apartamento multiproceso</span><span class="sxs-lookup"><span data-stu-id="81aa6-116">Multithreaded apartment</span></span>|  
|<span data-ttu-id="81aa6-117">Visual Basic</span><span class="sxs-lookup"><span data-stu-id="81aa6-117">Visual Basic</span></span>|<span data-ttu-id="81aa6-118">Subprocesamiento controlado simple</span><span class="sxs-lookup"><span data-stu-id="81aa6-118">Single-threaded apartment</span></span>|  
  
 <span data-ttu-id="81aa6-119">Para cambiar estos valores predeterminados, utilice la <xref:System.STAThreadAttribute> atributo para establecer el modelo de subprocesos para la aplicación o la llamada la <xref:System.Threading.Thread.SetApartmentState%2A?displayProperty=nameWithType> o <xref:System.Threading.Thread.TrySetApartmentState%2A?displayProperty=nameWithType> método antes de iniciar el subproceso para establecer el modelo de subprocesos para un subproceso determinado.</span><span class="sxs-lookup"><span data-stu-id="81aa6-119">To change these defaults, you use the <xref:System.STAThreadAttribute> attribute to set the threading model for the application, or call the <xref:System.Threading.Thread.SetApartmentState%2A?displayProperty=nameWithType> or <xref:System.Threading.Thread.TrySetApartmentState%2A?displayProperty=nameWithType> method before starting the thread to set the threading model for a particular thread.</span></span> <span data-ttu-id="81aa6-120">En C++, también se puede usar el [/CLRTHREADATTRIBUTE](https://msdn.microsoft.com/library/4907e9ef-5031-446c-aecf-0a0b32fae1e8) opción del vinculador para especificar el modelo de apartamento.</span><span class="sxs-lookup"><span data-stu-id="81aa6-120">In C++, you can also use the [/CLRTHREADATTRIBUTE](https://msdn.microsoft.com/library/4907e9ef-5031-446c-aecf-0a0b32fae1e8) linker option to specify the apartment model.</span></span>  
  
 <span data-ttu-id="81aa6-121">Las aplicaciones ASP.NET deben establecer el `ASPCompat` atributo de la [@ Page](https://msdn.microsoft.com/library/f06cf9e5-22bb-461d-8b8f-549e53ff40a4) la directiva a `true` para forzar el servicio por el grupo de subprocesos STA a la página.</span><span class="sxs-lookup"><span data-stu-id="81aa6-121">ASP.NET applications should set the `ASPCompat` attribute of the [@ Page](https://msdn.microsoft.com/library/f06cf9e5-22bb-461d-8b8f-549e53ff40a4) directive to `true` to force the page to be serviced by the STA thread pool.</span></span>  
  
 <span data-ttu-id="81aa6-122">Estos son algunos de los casos en los que desea usar el <xref:System.STAThreadAttribute> atributo para establecer explícitamente el modelo de subprocesos en contenedor uniproceso:</span><span class="sxs-lookup"><span data-stu-id="81aa6-122">Here are some of the cases in which you'll want to use the <xref:System.STAThreadAttribute> attribute to explicitly set the threading model to single-threaded apartment:</span></span>  
  
-   <span data-ttu-id="81aa6-123">Está desarrollando una aplicación de Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="81aa6-123">You're developing a Windows Forms app.</span></span> <span data-ttu-id="81aa6-124">Las aplicaciones de Windows Forms deben ser un único subproceso si se comunican con los componentes del sistema de Windows, como el Portapapeles o Windows cuadros de diálogo comunes, o si usan las características del sistema, como la funcionalidad de arrastrar y colocar.</span><span class="sxs-lookup"><span data-stu-id="81aa6-124">Windows Forms apps must be single-threaded if they communicate with Windows system components such as the Clipboard or Windows common dialog boxes, or if they use system features such as drag-and-drop functionality.</span></span> <span data-ttu-id="81aa6-125">La plantilla de aplicación de Windows Forms para C# agrega automáticamente el <xref:System.STAThreadAttribute> atributo a los proyectos de C#.</span><span class="sxs-lookup"><span data-stu-id="81aa6-125">The Windows Forms Application template for C# automatically adds the <xref:System.STAThreadAttribute> attribute to C# projects.</span></span> <span data-ttu-id="81aa6-126">Dado que el modelo de subprocesamiento controlado simple es el valor predeterminado para Visual Basic, no hace falta para el atributo.</span><span class="sxs-lookup"><span data-stu-id="81aa6-126">Because the single-threaded apartment model is the default for Visual Basic, there is no need for the attribute.</span></span>  
  
-   <span data-ttu-id="81aa6-127">Está desarrollando una aplicación de C# que llama a una biblioteca de Visual Basic, que, a su vez, se basa en interoperabilidad COM.</span><span class="sxs-lookup"><span data-stu-id="81aa6-127">You're developing a C# app that calls a Visual Basic library, which, in turn, relies on COM interop.</span></span> <span data-ttu-id="81aa6-128">Dado que el modelo de subprocesamiento controlado simple es el valor predeterminado para Visual Basic, debe cambiar modelo de subprocesos de la aplicación a un único subproceso con el <xref:System.STAThreadAttribute> atributo.</span><span class="sxs-lookup"><span data-stu-id="81aa6-128">Because the single-threaded apartment model is the default for Visual Basic, you should change your app's threading model to single-threaded by using the <xref:System.STAThreadAttribute> attribute.</span></span>  
  
-   <span data-ttu-id="81aa6-129">La aplicación realiza llamadas a componentes COM que usan el modelo de subprocesamiento controlado simple.</span><span class="sxs-lookup"><span data-stu-id="81aa6-129">Your application makes calls to COM components that use the single-threaded apartment model.</span></span>  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.MTAThreadAttribute" />
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public STAThreadAttribute ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.STAThreadAttribute.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; STAThreadAttribute();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.0.20.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="81aa6-130">Inicializa una nueva instancia de la clase <see cref="T:System.STAThreadAttribute" />.</span><span class="sxs-lookup"><span data-stu-id="81aa6-130">Initializes a new instance of the <see cref="T:System.STAThreadAttribute" /> class.</span></span></summary>
        <remarks>To be added.</remarks>
        <altmember cref="T:System.MTAThreadAttribute" />
      </Docs>
    </Member>
  </Members>
</Type>